#!/bin/zsh

# dot_Brewfile hash: {{ include "dot_Brewfile" | sha256sum }}

print -P "ğŸ”„ %F{blue}Homebrewã®ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™...%f"

brewfile="${HOME}/.Brewfile"

{{ if eq (env "CI") "true" -}}
export HOMEBREW_BUNDLE_BREW_SKIP="mas"
export HOMEBREW_BUNDLE_MAS_SKIP="$(cat "$brewfile" | grep '^mas ' | awk -F 'id: ' '{print $2}' | tr '\n' ' ')"
{{ end -}}

brew bundle --file="$brewfile" --force
brew bundle cleanup --file="$brewfile" --force
